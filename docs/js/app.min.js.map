{"version":3,"file":"app.min.js","sources":["../../src/js/app.js"],"sourcesContent":["import * as Queries from './_queries'\nimport * as Scales from './_scales'\n\nimport { fRenderHUD } from './components/_hud'\nimport { fRenderForecast } from './components/_forecast'\nimport { fRenderDetails } from './components/_details'\nimport { fErrorDisplay } from './components/_errors'\n\n/**\n * The Weather Service\n * @author bnjmnrsh@gmail.com\n *\n * @param {object} [_oSettings={}]\n */\n\nconst weatherApp = function (_oSettings = {}) {\n    const _oDefaults = {\n        target: '#app',\n        units: 'M',\n        debug: false,\n        dev: false,\n    }\n\n    // Merge settings with defaults\n    _oSettings = Object.assign(_oDefaults, _oSettings)\n\n    // API urls\n    const sIpapiLocationApi = 'https://ipapi.co/json/'\n    let sWeatherApi = `https://weatherserv.bnjmnrsh.workers.dev/?`\n\n    if (_oSettings.dev === true) {\n        sWeatherApi = `${sWeatherApi}&DEV=true`\n    }\n\n    // DOM Target\n    const nApp = document.querySelector(_oSettings.target)\n\n    // SVGs are staged in HTML for details section,\n    // the remainder of images are inlined(except Cloudcover & Moon, loaded dynamically)\n    const nIcons = document.querySelector('#svgs')\n    _oSettings.icon = {\n        // degrees/compass inline\n        sWind: nIcons.querySelector('.svg-wi-strong-wind').outerHTML,\n        sThermometer: nIcons.querySelector('.svg-wi-thermometer').outerHTML,\n        sWindDirection: nIcons.querySelector('.svg-wi-wind-deg').outerHTML,\n        sSnow: nIcons.querySelector('.svg-wi-snow').outerHTML,\n\n        // cloud lodaded dynamically\n        sRaindrop: nIcons.querySelector('.svg-wi-raindrop').outerHTML,\n        sBinoculars: nIcons.querySelector('.svg-binoculars').outerHTML,\n        sSunrise: nIcons.querySelector('.svg-wi-sunrise').outerHTML,\n        sSunset: nIcons.querySelector('.svg-wi-sunset').outerHTML,\n        sSunnyDay: nIcons.querySelector('.svg-wi-day-sunny').outerHTML,\n        // moon phases loaded as <img src=\"./svg/icons/moon/svg/${oMoon.phase}.svg\">\n    }\n\n    /**\n     * Build the UI\n     *\n     * @param {array} data\n     */\n    const fBuildUI = function (_oData) {\n        app.innerHTML =\n            fRenderHUD(_oData, _oSettings) +\n            fRenderDetails(_oData, _oSettings) +\n            fRenderForecast(_oData.DAILY.data, _oSettings)\n\n        // Adjust the visibility 'fogg' bar in the details section\n        Scales.fSetVisabilityScale(_oData.CURRENT.data[0].vis)\n    }\n\n    /**\n     * Init\n     */\n    const fInit = async function () {\n        try {\n            const loc = await Queries.fGetLocation(\n                sIpapiLocationApi,\n                _oSettings\n            )\n            const _oWeather = await Queries.fGetWeather(\n                loc,\n                sWeatherApi,\n                _oSettings\n            )\n\n            _oSettings.debug ? console.log('fGetLocation response:', loc) : ''\n            _oSettings.debug\n                ? console.log('fGetWeather response:', _oWeather)\n                : ''\n\n            fBuildUI(_oWeather)\n        } catch (e) {\n            console.error('init error: ', e)\n            nApp.innerHTML = fErrorDisplay(e)\n        }\n    }\n    // fInit()\n}\n\n// with debugging and Imperial Units\nconst settings = {\n    units: 'M',\n    debug: true,\n    dev: false,\n}\n\nweatherApp(settings)\n"],"names":["_oSettings","Object","assign","target","units","debug","dev","document","querySelector","nIcons","icon","sWind","outerHTML","sThermometer","sWindDirection","sSnow","sRaindrop","sBinoculars","sSunrise","sSunset","sSunnyDay","weatherApp"],"mappings":";0BAemB,SAAUA,EAAa,KAStCA,EAAaC,OAAOC,OARD,CACfC,OAAQ,OACRC,MAAO,IACPC,OAAO,EACPC,KAAK,GAI8BN,IAMxBM,IAKFC,SAASC,cAAcR,EAAWG,QAI/C,MAAMM,EAASF,SAASC,cAAc,SACtCR,EAAWU,KAAO,CAEdC,MAAOF,EAAOD,cAAc,uBAAuBI,UACnDC,aAAcJ,EAAOD,cAAc,uBAAuBI,UAC1DE,eAAgBL,EAAOD,cAAc,oBAAoBI,UACzDG,MAAON,EAAOD,cAAc,gBAAgBI,UAG5CI,UAAWP,EAAOD,cAAc,oBAAoBI,UACpDK,YAAaR,EAAOD,cAAc,mBAAmBI,UACrDM,SAAUT,EAAOD,cAAc,mBAAmBI,UAClDO,QAASV,EAAOD,cAAc,kBAAkBI,UAChDQ,UAAWX,EAAOD,cAAc,qBAAqBI,WAuD7DS,CANiB,CACbjB,MAAO,IACPC,OAAO,EACPC,KAAK"}